---
title:        2023년을 떠나며
date:         2023-12-24
categories:   [일상]
comments:     true
---

영화 "이터널 선샤인"에서 주인공 조엘은 옛 연인 클레멘타인이 자신에 관한 기억을 지워버렸다는 것을 알고 자신도 클레멘타인에 관한 기억을 제거하려 한다.

기억 제거 시술이 진행되는 의식 세계 속에서 조엘은 클레멘타인과의 기억이 소중했음을 깨닫고, 사라져가는 기억을 붙잡기 위해 클레멘타인을 데리고 도망치기 시작한다.

비록 힘들고 고통스럽더라도 누군가를 기억하고, 누군가에게 기억된다는 사실은 굉장히 소중한 것임을 영화는 말하고 있다. 조엘과 클레멘타인의 행복하고 행복했던 장면들이 오버랩되며 넷플릭스에게 뺐겼던 내 정신은 이윽고 현실로 돌아온다.

이렇게 소중한 기억을 나는 소중하게 여기고 있었는가? 스스로에게 되물으며 생각에 잠긴다. 평소 사라지면 좋겠다고 생각했던 기억이 있었기에 이 영화의 감상은 다른 영화에 비해 꽤 오랜 여운이 남았다.

아무튼 이런저런 이유로 이번 연말에는 2023년 소중한 기억들을 글로 남겨보고자 한다.

## 11~12월

이직한지 두 달이 다되어 간다. 베일에 싸인듯한 회사의 바깥 이미지와 달리 여태 다녔던 회사들 중에서 가장 훌륭하고 따뜻한 온보딩을 경험하고 있는 중이다.

새로 합류하게된 팀에서는 지금까지 데이터 엔지니어가 없었기에 데이터 분석가와 사이언티스트 분들이 직접 데이터 파이프라인을 개발하고 있었다. 그렇다 보니 구현된 배치 로직 전반에서 성능이나 비용보다는 데이터 품질에 훨씬 더 많은 신경을 쓰고 있다는게 느껴졌다. 데이터를 사용하는 소비자 관점에선 어떤 기술을 썼느냐 보다는 데이터를 믿을 수 있느냐가 중요하기에 결국 데이터 엔지니어로서의 가장 큰 책임은 신뢰 가능한 데이터 사용 환경 구축임을 다시 한번 느낄 수 있었다.

따라서 이곳에서의 내 첫 임무는 데이터 파이프라인을 신뢰성 있게 개선하고 데이터 마트를 개편하는 작업이 되었다. 지금까지 데이터팀에서 쌓아두었던 엔지니어링 과제를 하나씩 해결하고 있으며, 그 과정 속에서 회사의 도메인과 데이터에 익숙해지고 있다.

한가지 문제가 있다면 바로 언어(~~자연어~~)인데, 현재 내가 속한 팀은 다국적으로 구성되어 있어 영어로 의사소통하고 있다. 덕분에 학창시절에 열심히 하지 않은 나를 열심히 원망하며 뒤늦게 영어 공부를 열심히 하는 중이다. 가끔 들리지 않는 악센트로 인해 의지가 박살날 때도 있지만.

## 8~10월

마침내 다니고 있던 회사를 퇴사하기로 마음 먹었다. 충동적으로 결정한 것은 아니고, 내가 퇴사해야만 하는 이유를 밤세워가며 정리해 내린 결정이었다. 사실 한켠에는 떠나고 싶지 않은 마음도 없지 않아 있었지만 회사도 딱히 나를 붙잡고자 하는 의도가 보이지 않았다. 회사에 대한 신뢰를 잃었기 때문에 떠나기로 마음 먹은거였는데, 막상 카운터 오퍼를 서류가 아닌 구두로만 받으니 잔류했다간 후회할 확률이 크다고 판단해 선택지에서 아예 배제하였다.

이번 퇴사를 통해 내가 깨달을 수 있었던 것은 크게 2가지 였던 것 같다.

### 1. 절대 험담하지 말자.

내가 누군가를 험담해서가 아니다. 이번 직장을 다니면서 동료를 험담하는 누군가들을 너무 많이 봐왔고, 이는 자신의 전문성을 스스로 깎아내린다는 것을 간접적으로 깨달았다. 신뢰할 수 없는 동료를 곁에 두는 것만큼 직장 생활에서 힘든 일은 없다. 누군가 당신에게 다른 사람의 험담을 한다면, 그 사람은 당신을 험담하고 있을 수도 있다. 직접 겪고나니 가십을 더더욱 경계해야 겠다는 생각이 들었다.

### 2. 태도가 가장 중요하다.

협업을 하다보면 함께 일하고 있는 동료가 어떠한 마음가짐으로 일을 하고 있는지 느껴질 때가 많다. 사소한 내용에도 주석을 달거나 회의를 잡아 친절하게 설명해주는 배려 해주는 동료가 있는 반면, 알아서 리뷰 단계에서 고쳐주겠지라는 생각으로 문법부터 오류가 나는 코드를 전달하는 동료도 있었다.

놀라웠던 것은 배려심이 깊었던 동료는 실력이 뛰어남에도 불구하고 자신을 끊임없이 의심하고 있었고, 그렇지 않은 동료는 실력이 부족함에도 자신에 대한 굉장한 확신을 갖고 있었다. 절대 내가 감히 누군가의 실력을 판단하겠다는 것이 아니라 전자와 같은 동료가 되기 위해 노력해야겠다는 의미이다.

물론 사람은 언제나 실수를 하기에 단편적으로 사람을 판단해서는 안된다. 그러나 실수가 계속 반복된다면 한번쯤 스스로를 점검해야 하지 않을까 생각해본다. 그렇기에 나도 항상 스스로를 점검하고 태도를 바로잡을 필요가 있다.

퇴사 후에는 시간 맞는 친구들과 베트남 다낭 및 일본 삿포로로 여행을 갈 예정이다.

## 3~7월

일하기에 너무 좋은 날씨이다. 회사에서 제법 많은 업무들을 소화하였다. 개중에는 평소 관심있던 기술 스택도 많았는데 이번 기회에 쭈욱 정리해보려고 한다.

### 1. 추천 시스템

주로 추천 서버를 개선하는 작업을 진행하였다. 서버 개발에 사용하는 언어는 Kotlin으로 통일되어 있었고 IO를 효과적으로 non-blocking 처리하기 위해 Webflux를 사용하고 있었다. 그런데 추천 서버의 복잡성이 커지다보니 서비스 계층의 깊이가 깊어지면서 코드의 가독성이 떨어지고 디버깅이 힘들어지는 문제점이 발생하였다.

따라서 우리는 Reactive, 즉 event loop를 유지했을 때 이점이 되는 부분을 제외하곤 나머지를 Kotline Cororutine으로 전환하기로 결정하였다. 아예 새로운 서버를 띄워 Coroutine으로 작성된 코드를 배포한 후, API Gateway를 통해 엔드포인트를 차례대로 이관하는 작업을 진행하였다.

작업을 진행하는 동안 Redis 캐싱이나 필터를 개선하거나 nGrinder를 통해 성능을 테스트 하는 등, 벡엔즈 분야의 많은 부분을 공부하고 직접 개발해 볼 수 있어서 만족스러웠다.

### 2. 데이터 엔지니어링

평소 관심 있던 Snowflake, Airbyte 등 데이터 파이프라인과 관련된 여러 기술 스택을 PoC하는 기회를 얻어 진행하였다. 우리가 이미 사용하고 있던 추천 모델 학습-추론 파이프라인이 있었는데 그 일부를 Snowflake로 대체하는 작업이었다. 

Data Ingestion 파이프라인은 Spark를 이용해 원천 DB로부터 S3에 적재한 후, COPY를 통해 Snowflake의 stage로 떠오는 방식으로 개발하였다. 이후 Snowflake에서 간단한 쿼리와 UDF의 조합으로 추천 모델을 개발하여 MySQL로 reversed ETL하도록 하였다.

결과적으로 AWS Redshift를 온디멘드로 사용하는 것보다 더 많은 비용이 예상되어 도입하지 않기로 결정하였다. 성능이나 권한 관리 측면에서 Snowflake가 뛰어나긴 했지만 사용한 만큼 요금을 내야 했기에 비용을 아끼기 위해서는 쿼리와 배치 스케쥴링 전략에 상당한 숙련도가 요구되었다. 스키마 추론이나 에러 헨들링이 간편하다는 점은 매우 만족스러웠다.

개인적으로 데이터 클라우드가 발전할수록 데이터 엔지니어의 역할이 줄어들거라 생각해 헷지 개념으로 Snowflake 주식을 매입하고 있다. ~~그리고 물타기 중이다~~

### 3. A/B 테스트 프레임워크

회사 임직원들 누구나 A/B 테스트를 진행해볼 수 있도록 실험 플랫폼 및 프레임워크를 자체 개발하였다. 처음으로 프론트엔드 개발자와 협업한거라 재미도 있었고 성장했다는 느낌이 들어 좋았다. 이에 대한 내용은 다른 글을 통해 다루어보려 한다.
