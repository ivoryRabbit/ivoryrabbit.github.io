---
title:        Project Nessie로 데이터 버전 관리하기
date:         2024-01-05
categories:   [Data, Engineering]
tags:         [nessie, iceberg, data lake]
comments:     true
image:
    path:     /assets/img/posts/2024-12-27/main.png
    alt:      project nessie
description:  Apache Iceberg를 사용할 때 데이터의 version control을 돕는 Project Nessie를 살펴보았습니다.
---

<style>
H2 { color: #298294 }
H3 { color: #1e7ed2 }
H4 { color: #C7A579 }
</style>

## Project Nessie

과거에는 분석 환경에서 데이터가 담긴 파일을 분산 처리하기 위해 주로 Apache Hive를 사용했다. 이때 Hive는 테이블 스키마 등의 메타데이터를 저장하고 API를 통해 저장된 메타데이터 정보를 전달하는 수단, 즉 **카탈로그** 서비스를 위해 Hive metastore를 사용한다.

Project Nessie는 이 Hive metastore를 대체할 수 있는 카탈로그 오픈 소스로서, Apache Iceberg를 사용할 때 엔지니어가 데이터의 버전을 **잘** 관리할 수 있도록 UI 및 API를 제공한다.

Iceberg는 쿼리 엔진이 아니기 때문에, Hive의 알맞은 비교 대상으로 보긴 어렵지만 굳이 차이를 정리해보자면 다음과 같다.

#### Hive vs Iceberg

| - | Hive | Iceberg |
| :---: | --- | --- |
| 유형 | Data Warehouse | Data Lake 용 테이블 포맷 |
| 목적 | 구조화된 데이터를 저장하고 처리하기 위한 플랫폼 | Data Lake에서 신뢰성 있고 효율적인 테이블 관리를 제공 |
| 데이터 저장 | HDFS, S3, GCS 등과 같은 분산 파일 시스템 | 동일 |
| 지원 포맷 | Text, ORC, Parquet Avro | 동일 |
| 메타데이터 저장 | Hive Metastore(RDB) | HDFS, S3 등 Object storage에 저장 |
| 카탈로그 | Hive Metastore | Hive Metastore, AWS Glue, Nessie 등 사용 가능 |
| 데이터 업데이트 | 데이터 삽입, 삭제 시 파일 전체를 다시 작성해야 함 | 데이터 삽입, 삭제 및 병합 작업이 효율적으로 수행 가능 |
| 분산 환경 | Hive Metastore와 MapReduce 중심 | Spark, Flink, Presto와 같은 분산 처리 엔진과 호환 가능 |
| 타임 트래블 | 지원 안 함 | 지원 (과거 스냅샷 조회 가능) |
| 병렬 작업 | 제한적 (충돌 방지 기능이 부족함) | 멀티 브랜칭 및 병합 작업 지원 (Nessie와의 연동으로 더욱 강력해짐) |
| 분석 작업 | 전통적인 배치 처리에 적합 | 실시간 및 배치 처리 모두에 적합 |


### Project Nessie

## Practice

- [https://github.com/ivoryRabbit/play-data-with-docker/tree/master/nessie](https://github.com/ivoryRabbit/play-data-with-docker/tree/master/nessie){: target="_blank"}

