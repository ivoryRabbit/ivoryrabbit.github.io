---
title:        A/B 테스트 결과를 빨리 보고 싶어질 때면, CUPED
date:         2024-12-07
categories:   [Data, Analysis]
comments:     true
---

<style>
H2 { color: #298294 }
H3 { color: #1e7ed2 }
H4 { color: #C7A579 }
</style>

---

## A/B 테스트란?

**A/B 테스트**란 사용자 경험 개선을 위해 두 가지의 다른 옵션(A와 B)을 비교하여 최적의 선택을 도출하는 실험 설계 기법이다. 데이터 분석 환경이 갖추어진 많은 회사들이 UI 혹은 알고리즘을 개선할 때 A/B 테스트를 이용해 의사결정하고 있다.

통계학에서는 **가설 검정**이란 이름으로 더 잘 알려져 있는데, 온라인 실험 환경에서 데이터 기반 의사결정을 목적으로 수행되는 경우에 특별히 A/B 테스트라고 부르는 듯 하다.

이해를 돕기 위해 웹 사이트에서 버튼 색상을 변경했을 때 클릭률(Click-Through Rate, CTR)에 어떤 영향을 미치는지 분석하는 상황을 가정해보자.

| | 유형 | 설명 | 표본 수 | CTR |
| --- | :--- | :--- | ---: | ---: |
| A 그룹 | 대조군 | 흰색 배경에 회색 버튼 | 100 | 13% |
| B 그룹 | 실험군 | 흰색 배경에 빨간색 버튼 | 100 | 15% |

위 실험 결과를 토대로 우리는 빨간색 버튼의 CTR이 회색 버튼 보다 높기 때문에, 버튼 색깔을 빨간색으로 교체하도록 결론을 내릴 수 있다.

### p-value

하지만 이 결론에 오류는 없는 걸까? 다시 의사결정 과정으로 돌아가보자. 우리는 이미 기존에 회색 버튼을 사용하고 있었으므로 최악의 상황은 버튼 색깔을 바꾸었을때 CTR이 감소하는 것이다.

| 실제 \ 결정 | 색깔 유지(N) | 색깔 교체(P) |
| --- | :--- | :--- |
| CTR 상승 | - | 뿌듯함(TP) | 
| CTR 유지 | 당연함(TN) | 아쉬움(FP) | 
| CTR 감소 | - | 최악(FP) |

즉, 긍정이라 판단했지만 실제론 아닌 경우(False Positive, FP)에 가장 유의하여 의사결정을 해야 했다.

다행히도 우리는 고등학교에서 이를 1종 오류라고 정의하고 정량적으로 측정할 수 있는 수단을 배웠~~었~~는데, 바로 **p-value**이다. p-value는 실험군의 데이터가 대조군의 확률 분포로부터 얼마나 관측될 만한 지를 의미한다.

따라서 p-value가 높을수록 실험군의 통계값을 신뢰하기 어렵기 때문에, 실험 전에 미리 설정해둔 **유의수준**을 넘겼다면 실험 결과를 의사결정에 사용하는데 주의를 기울여야 한다.

이제 Python을 이용해 예시의 **p-value**를 계산해보자.

```python
from scipy.stats import binomtest

test = binomtest(k=15, n=100, p=0.13, alternative="greater")
print(f"p-value: {test.pvalue:0.3f}")
```

#### [실행 결과]
```
p-value: 0.317
```

일반적으로 유의수준을 0.05 ~ 0.10 사이로 둔다는 점을 고려해보면, 0.317이라는 수치는 너무 높다. 따라서 **아직은** 이 실험 결과를 신뢰할 수 없다.


### t-test



## CUPED

CUPED(Controlled Using Pre-Existing Data)



